import{_ as N,r as l,E as x,K as S,J as C,v as c,x as t,R as n,S as r,y as q,L as U,M as O,T as B,t as V}from"./Dcd5bFKn.js";import{P as F}from"./C4YHeYHv.js";import{u as J}from"./DECbbcjI.js";import"./_9T6-H5m.js";import"./DRckOv8H.js";const M={class:"new-poll-container"},R={class:"form-group"},I={class:"form-group"},L={class:"form-group"},$={class:"form-group"},K={class:"form-group"},W={class:"form-group"},j={class:"form-group"},z={class:"form-group"},G=["onUpdate:modelValue"],H={__name:"new",setup(Q){const T="0xC78375119f32206464D6Ef9b3064195991B4D244",w=F.abi,i=l(""),p=l(""),v=l(""),f=l(0),a=l(0),g=l(0),b=l(18),y=l(""),s=l([""]);x([f,a],()=>{g.value=f.value*a.value});const P=S(),{address:D}=C(),{writeContractAsync:E}=J({address:T,abi:w,functionName:"createPoll"}),k=()=>{s.value.push("")},A=async()=>{try{if(!i.value||!p.value||!v.value||!s.value.length)throw new Error("All fields must be filled correctly.");const d=new Date(`${p.value}T${v.value}`),e=Math.floor(d.getTime()/1e3);if(e<=Math.floor(Date.now()/1e3))throw new Error("End date and time must be in the future.");const o=JSON.parse(JSON.stringify(s.value.map(u=>u.trim())));if(!o.length||!o.every(u=>typeof u=="string"&&u.trim().length>0))throw new Error("Poll options must be valid, non-empty strings.");console.log("Options before contract call:",o),console.log("Options JSON stringified:",JSON.stringify(o)),console.log("Creating poll with data:",{pollName:i.value,options:o,endDate:e,minAge:b.value,location:y.value,minTokensRequired:a.value,totalTokenSupply:g.value});const m=await E({address:T,abi:w,functionName:"createPoll",args:[i.value,o,e,b.value,y.value,a.value,g.value],gasLimit:3e6,account:D.value});console.log("Transaction successful:",m),alert("Poll created successfully!"),P.push("/dashboard/instance")}catch(d){console.error("Error creating poll:",d),alert(d.message||"Failed to create poll")}};return(d,e)=>(V(),c("div",M,[e[19]||(e[19]=t("h1",null,"Create a new Poll",-1)),e[20]||(e[20]=t("p",null,"Create new Poll for voting.",-1)),t("form",{onSubmit:B(A,["prevent"])},[t("div",R,[e[7]||(e[7]=t("label",{for:"pollName"},"Poll Name:",-1)),n(t("input",{type:"text",id:"pollName","onUpdate:modelValue":e[0]||(e[0]=o=>i.value=o),required:""},null,512),[[r,i.value]])]),t("fieldset",null,[e[10]||(e[10]=t("legend",null,"Set Poll End Date and Time",-1)),t("div",I,[e[8]||(e[8]=t("label",{for:"endDate"},"End Date:",-1)),n(t("input",{type:"date",id:"endDate","onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),required:""},null,512),[[r,p.value]])]),t("div",L,[e[9]||(e[9]=t("label",{for:"endTime"},"End Time:",-1)),n(t("input",{type:"time",id:"endTime","onUpdate:modelValue":e[2]||(e[2]=o=>v.value=o),required:""},null,512),[[r,v.value]])])]),t("fieldset",null,[e[14]||(e[14]=t("legend",null,"Calculate Voting Token amount",-1)),t("div",$,[e[11]||(e[11]=t("label",{for:"expectedVoters"},"Expected Voter amount:",-1)),n(t("input",{type:"number",id:"expectedVoters","onUpdate:modelValue":e[3]||(e[3]=o=>f.value=o),required:""},null,512),[[r,f.value,void 0,{number:!0}]])]),t("div",K,[e[12]||(e[12]=t("label",{for:"tokensPerVoter"},"Tokens per Voter:",-1)),n(t("input",{type:"number",id:"tokensPerVoter","onUpdate:modelValue":e[4]||(e[4]=o=>a.value=o),required:""},null,512),[[r,a.value,void 0,{number:!0}]])]),t("div",W,[e[13]||(e[13]=t("label",null,"Total token amount:",-1)),t("span",null,q(g.value),1)])]),t("div",j,[e[15]||(e[15]=t("label",{for:"minAge"},"Voter minimum age:",-1)),n(t("input",{type:"number",id:"minAge","onUpdate:modelValue":e[5]||(e[5]=o=>b.value=o),required:""},null,512),[[r,b.value,void 0,{number:!0}]])]),t("div",z,[e[16]||(e[16]=t("label",{for:"location"},"Voter location:",-1)),n(t("input",{type:"text",id:"location","onUpdate:modelValue":e[6]||(e[6]=o=>y.value=o),required:""},null,512),[[r,y.value]])]),t("fieldset",null,[e[17]||(e[17]=t("legend",null,"Create Poll Statements",-1)),(V(!0),c(U,null,O(s.value,(o,m)=>(V(),c("div",{key:m,class:"form-group"},[n(t("input",{type:"text","onUpdate:modelValue":u=>s.value[m]=u,placeholder:"Enter poll statement",required:""},null,8,G),[[r,s.value[m]]])]))),128)),t("button",{class:"add-option-button",type:"button",onClick:k},"ADD OPTION")]),e[18]||(e[18]=t("button",{type:"submit",class:"create-button"},"CREATE",-1))],32)]))}},ee=N(H,[["__scopeId","data-v-1a2d6489"]]);export{ee as default};

import{_ as O,r as t,P as z,J as C,o as I,v as p,x as n,y as l,L,M as R,N as u,t as v}from"./CUp-TJhH.js";import{P as B}from"./ClhTlj9r.js";import{r as d}from"./BRfHbl6E.js";import"./CvP2IWBu.js";const E={class:"poll-container"},U={key:0,class:"loading"},V={key:1,class:"poll-data"},q={class:"poll-header"},M={class:"poll-info"},S={class:"poll-options"},D={class:"option-title"},J={class:"vote-count"},Y={__name:"index",setup($){const c=B.abi,A=t(""),g=t(""),b=t(!1),k=t(""),y=t(""),F=t(""),P=t(""),T=t([]),f=t(!1),s=z().params.pollId,{address:a,isConnected:w}=C(),x=()=>{f.value=!0;const e={};d(u,{address:s,abi:c,functionName:"pollTitle",account:a.value}).then(o=>(e.title=o||"Unknown",d(u,{address:s,abi:c,functionName:"endDate",account:a.value}))).then(o=>(e.endDate=o?new Date(Number(o)*1e3).toLocaleString():"N/A",d(u,{address:s,abi:c,functionName:"isFinalized",account:a.value}))).then(o=>(e.isFinalized=o||!1,d(u,{address:s,abi:c,functionName:"creator",account:a.value}))).then(o=>(e.creator=o||"Unknown",d(u,{address:s,abi:c,functionName:"getEligibility",account:a.value}))).then(o=>(Array.isArray(o)&&([e.minAge,e.location,e.minTokensRequired]=o),d(u,{address:s,abi:c,functionName:"getTotalOptions",account:a.value}))).then(o=>{const i=Number(o||0);e.totalOptions=i;const m=[];let _=0;if(i>0)for(let N=0;N<i;N++)d(u,{address:s,abi:c,functionName:"votingOptions",args:[N],account:a.value}).then(r=>{m.push({description:(r==null?void 0:r[0])||"N/A",voteCount:Number((r==null?void 0:r[1])||0)}),_++,_===i&&(e.options=m,h(e))}).catch(r=>{console.error(`Failed to fetch option ${N}:`,r),_++,_===i&&h(e)});else e.options=[],h(e)}).catch(o=>{console.error("Error fetching poll data:",o),f.value=!1})},h=e=>{A.value=e.title||"Unknown",g.value=e.endDate||"N/A",b.value=e.isFinalized||!1,k.value=e.creator||"Unknown",y.value=e.minAge||"N/A",F.value=e.location||"N/A",P.value=e.minTokensRequired||"N/A",T.value=e.options||[],f.value=!1};return I(()=>{s&&a.value&&w.value&&x()}),(e,o)=>(v(),p("div",E,[f.value?(v(),p("div",U,o[0]||(o[0]=[n("p",null,"Loading poll data...",-1)]))):(v(),p("div",V,[n("div",q,[n("h1",null,"Poll: "+l(A.value),1),n("div",M,[n("p",null,"Creator: "+l(k.value||"N/A"),1),n("p",null,"End Date: "+l(g.value||"N/A"),1),n("p",null,"Location Restriction: "+l(F.value||"N/A"),1),n("p",null,"Tokens Per Voter: "+l(P.value||"N/A"),1),n("p",null,"Minimum Age: "+l(y.value||"N/A"),1),n("p",null,"Is Finalized: "+l(b.value?"Yes":"No"),1)])]),n("div",S,[o[1]||(o[1]=n("h2",null,"Voting Options:",-1)),(v(!0),p(L,null,R(T.value,(i,m)=>(v(),p("div",{key:m,class:"poll-option-row"},[n("div",D,l(i.description),1),n("div",J,"Votes: "+l(i.voteCount),1)]))),128))])]))]))}},W=O(Y,[["__scopeId","data-v-e76f535b"]]);export{W as default};
